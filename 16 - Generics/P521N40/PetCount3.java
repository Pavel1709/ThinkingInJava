//: typeinfo/PetCount3.java // Using isInstance() 
import typeinfo.pets.*; 
import java.util.*;
import net.mindview.util.*;
import static net.mindview.util.Print.*;
public class PetCount3 {
 static class PetCounter extends LinkedHashMap<Class<? extends Pet>,Integer> {
  public PetCounter() { 
   super(MapData.map(typeinfo.pets.LiteralPetCreator.allTypes, 0));
  }
  public void count(Pet pet) {
   // Class.isInstance() eliminates instanceofs: 
   for(Map.Entry<Class<? extends Pet>,Integer> pair : entrySet())     
    if(pair.getKey().isInstance(pet))
     put(pair.getKey(), pair.getValue() + 1); 
  }
  public String toString() {
   StringBuilder result = new StringBuilder("{"); 
   for(Map.Entry<Class<? extends Pet>,Integer> pair : entrySet()){ 
    result.append(pair.getKey().getSimpleName()); 
    result.append("=");
    result.append(pair.getValue()); 
    result.append(", ");
   }
   result.delete(result.length()-2, result.length()); 
   result.append("}");
   return result.toString();
  } 
 }
 public static void main(String[] args) {
  PetCounter petCount = new PetCounter();
  for(Pet pet : Pets.createArray(20)) {
   printnb(pet.getClass().getSimpleName() + " ");
   petCount.count(pet); 
  }
  print();
  print(petCount);
 }
} /* Output:
EgyptianMau Gerbil Cymric EgyptianMau Cymric EgyptianMau Pug Rat Mutt Cymric Manx Manx Manx Cymric EgyptianMau Pug Hamster Cymric Gerbil Pug 
{Pet=20, Dog=4, Cat=12, Rodent=4, Mutt=1, Pug=3, EgyptianMau=4, Manx=8, Cymric=5, Rat=1, Mouse=0, Hamster=1, Gerbil=2}*///:~